<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8" />
		<title>File API</title>
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<style>
		</style>
	</head>
	<body>
		<header role="banner">
			<h1>File API</h1>
			<p>File APIの練習サイトです。</p>
		</header>

		<main>
			<section>
				<h2>Fileのメタ情報を取得</h2>
				<div>
					<textarea id="FileMetaInfo" cols="50" rows="10" readonly="readonly">
					</textarea>
				</div>
				<p><input id="FileMetaTarget" type="file" multiple="multiple" /></p>
				<p><button id="FileMetaInfoGetter">メタ情報取得</button></p>
			</section>
		</main>

		<footer role="contentinfo">
			<small>Copyright &copy; 2014 moguonyanko All rights reserved.</small>
		</footer>

		<script>
			(function (win, doc) {

				/* 引数からファイルの情報は得られない。 */
				function handleFiles() {
					var selectedFiles = this.files;

					var dispFileMetaInfo = function (evt) {
						var infoArea = doc.getElementById("FileMetaInfo");
						infoArea.value = "";

						var info = [];
						if (selectedFiles) {
							for (var i = 0; i < selectedFiles.length; i++) {
								var file = selectedFiles[i];
								info.push("ファイル名：" + file.name);
								info.push("ファイルサイズ：" + file.size);
								info.push("ファイルMIMEタイプ：" + file.type);
								info.push("------------------------------");
							}

							infoArea.value += info.join("\n");
						}
					};
					
					var infoGetter = doc.getElementById("FileMetaInfoGetter");
					infoGetter.onclick = dispFileMetaInfo;
				}

				function addEventListener() {
					var fileInput = doc.getElementById("FileMetaTarget");
					fileInput.addEventListener("change", handleFiles, false);
				}

				function init() {
					addEventListener();
				}

				init();

			}(window, document));
		</script>
	</body>
</html>
